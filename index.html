<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Tano - Empanadas Artesanales</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="config_pago.js"></script>
</head>
<body class="light-theme">
    <!-- Header -->
    <header>
        <a href="#inicio" class="logo">
            <img src="Empanadas Congeladas.png" alt="El Tano - Empanadas">
        </a>
        <nav>
            <ul class="nav-links">
                <li><a href="#inicio">Inicio</a></li>
                <li><a href="#catalogo">Cat√°logo</a></li>
                <li><a href="#nosotros">Nosotros</a></li>
                <li><a href="#contacto">Contacto</a></li>
            </ul>
            <div class="nav-actions">
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                    <span>Dark</span>
                </button>
                <button class="cart-btn" id="cartBtn">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count" id="cartCount">0</span>
                </button>
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="inicio">
        <div class="hero-content">
            <h1> <span>No sab√©s qu√© comer</span> 
                pero sab√©s que quer√©s algo rico.</h1>  
                 
            <p>En El Tano te lo hacemos f√°cil: empanadas congeladas con sabor casero, listas para compartir en cualquier momento.</p>
            <div class="hero-buttons">
                <a href="#catalogo" class="btn-primary">Ver Cat√°logo</a>
                <a href="#nosotros" class="btn-secondary">Con√≥cenos</a>
            </div>
        </div>
        <div class="hero-image">
            <div class="hero-empanada">

            </div>
        </div>
    </section>

    <!-- Categories -->
    <section class="categories" id="catalogo">
        <h2 class="section-title">Nuestro Cat√°logo</h2>
        <p class="section-subtitle">Explora todas nuestras variedades de empanadas</p>
        
        <div class="category-filters">
            <button class="category-btn active" data-category="todas">
                <i class="fas fa-th-large"></i> Todas
            </button>
            <button class="category-btn" data-category="carne">
                <i class="fas fa-drumstick-bite"></i> Carne
            </button>
            <button class="category-btn" data-category="pollo">
                <i class="fas fa-egg"></i> Pollo
            </button>
            <button class="category-btn" data-category="verduras">
                <i class="fas fa-carrot"></i> Verduras
            </button>
            <button class="category-btn" data-category="queso">
                <i class="fas fa-cheese"></i> Queso
            </button>
            <button class="category-btn" data-category="jamon">
                <i class="fas fa-bacon"></i> Jam√≥n
            </button>
            <button class="category-btn" data-category="integral">
                <i class="fas fa-leaf"></i> Integrales
            </button>
            <button class="category-btn" data-category="vegano">
                <i class="fas fa-seedling"></i> Vegan
            </button>
            <button class="category-btn" data-category="sin_gluten">
                <i class="fas fa-ban"></i> Sin Gluten
            </button>
            <button class="category-btn" data-category="premium">
                <i class="fas fa-crown"></i> Premium
            </button>
            <button class="category-btn" data-category="dulce">
                <i class="fas fa-birthday-cake"></i> Dulces
            </button>
        </div>
    </section>

    <!-- Products -->
    <section class="products-section">
        <div class="products-grid" id="productsGrid">
            <!-- Products will be inserted by JavaScript -->
        </div>
    </section>

    <!-- Features -->
    <section class="features" id="nosotros">
        <h2 class="section-title">¬øPor Qu√© Elegirnos?</h2>
        <p class="section-subtitle">Sabor aut√©ntico, listo cuando vos quieras.</p>
        
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-leaf"></i>
                </div>
                <h3>Ingredientes Frescos</h3>
                <p>Seleccionamos productos de primera calidad para que cada empanada conserve su sabor casero.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-hands"></i>
                </div>
                <h3>Artesanales</h3>
                <p>Recetas tradicionales, hechas a mano y congeladas al instante para mantener su frescura.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-truck"></i>
                </div>
                <h3>Entrega Din√°mica</h3>
                <p>Recib√≠ tus empanadas congeladas en tiempo r√©cord, listas para hornear y disfrutar sin esperas.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <h3>Ricas y Pr√°cticas</h3>
                <p>El mismo amor y dedicaci√≥n, ahora con la comodidad de tenerlas siempre a mano en tu freezer.</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contacto">
        <div class="footer-content">
            <div class="footer-section">
                <h4>El Tano</h4>
                <p>Las mejores empanadas artesanales de la ciudad. Tradici√≥n y sabor en cada bocado.</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h4>Enlaces R√°pidos</h4>
                <a href="#inicio">Inicio</a>
                <a href="#catalogo">Cat√°logo</a>
                <a href="#nosotros">Nosotros</a>
                <a href="#contacto">Contacto</a>
            </div>
            <div class="footer-section">
                <h4>Horarios</h4>
                <p>Lunes a Domingo</p>
                <p>10:00 - 22:00 hrs</p>
            </div>
            <div class="footer-section">
                <h4>Contacto</h4>
                <p><i class="fas fa-phone"></i> +598 91 234 567</p>
                <p><i class="fas fa-map-marker-alt"></i> Ciudad de la Costa, Uruguay</p>
                <p><i class="fas fa-envelope"></i> empandascongeladas1@gmail.com</p>
            </div>
            <div class="footer-section">
                <h4>Zona de Reparto</h4>
                <p><i class="fas fa-truck"></i> Ciudad de la Costa y alrededores</p>
                <p style="font-size: 0.85rem; opacity: 0.8;">Consult√° por otras zonas</p>
            </div>
            <div class="footer-section">
                <h4>M√©todos de Pago</h4>
                <p><i class="fas fa-money-bill-wave"></i> Efectivo</p>
                <p><i class="fas fa-university"></i> Transferencia</p>
                <p><i class="fab fa-cc-mastercard"></i> Mercado Pago</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 El Tano - Empanadas Artesanales. Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- Cart Sidebar -->
    <div class="nav-overlay" id="navOverlay"></div>
    <div class="cart-overlay" id="cartOverlay"></div>
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Tu Carrito</h3>
            <button class="cart-close" id="cartClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="cart-items" id="cartItems">
            <p style="text-align: center; opacity: 0.7;">Tu carrito est√° vac√≠o</p>
        </div>
        <div class="cart-total">
            <span>Total:</span>
            <span id="cartTotal">$0</span>
        </div>
        
        <!-- customerForm placeholder --> 
        <div id="customerForm" class="customer-form" style="display: none;">
            <h4><i class="fas fa-user-circle"></i> Datos del Pedido</h4>
            
            <!-- Datos personales -->
            <input type="text" id="customerName" placeholder="Nombre completo *" required>
            <input type="tel" id="customerPhone" placeholder="Tel√©fono *" required>
            <input type="email" id="customerEmail" placeholder="Email *" required>
            
            <!-- Direcci√≥n de entrega -->
            <input type="text" id="customerAddress" placeholder="Direcci√≥n de entrega * (calle y n√∫mero)">
            <input type="text" id="customerNote" placeholder="Referencia (opcional - ej: entre calles, color de casa)">
            
            <!-- Fecha de entrega -->
            <input type="date" id="deliveryDate" min="">
            
            <!-- M√©todo de pago -->
            <h4 style="margin-top: 1rem;"><i class="fas fa-credit-card"></i> M√©todo de Pago</h4>
            <div class="payment-options">
                <label class="payment-option">
                    <input type="radio" name="payment" value="mp" checked>
                    <span class="payment-icon">üí≥</span>
                    <span>Mercado Pago</span>
                </label>
                <label class="payment-option">
                    <input type="radio" name="payment" value="cash">
                    <span class="payment-icon">üíµ</span>
                    <span>Efectivo</span>
                </label>
            </div>
            
            <!-- Resumen del pedido -->
            <div id="orderSummary" class="order-summary"></div>
        </div>
        
        <button class="checkout-btn" id="checkoutBtn">Finalizar Pedido</button>
    </div>

    <script>
        // Products Data
        const products = [
            // EMPANADAS DE CARNE
            {
                id: 1,
                name: "Carne Suave",
                category: "carne",
                description: "Carne, huevo, cebolla y morr√≥n.",
                price: 420,
                icon: "fa-drumstick-bite"
            },
            {
                id: 2,
                name: "Mendocina",
                category: "carne",
                description: "Carne, aceitunas, cebolla y morr√≥n.",
                price: 420,
                icon: "fa-drumstick-bite"
            },
            {
                id: 3,
                name: "Picante",
                category: "carne",
                description: "Carne, aceitunas, huevo, cebolla, morr√≥n, tabasco y especias.",
                price: 420,
                icon: "fa-fire"
            },
            {
                id: 4,
                name: "Americana",
                category: "carne",
                description: "Carne, cebolla, morr√≥n, panceta y muzzarella.",
                price: 420,
                icon: "fa-drumstick-bite"
            },
            {
                id: 6,
                name: "Burger Empanada",
                category: "carne",
                description: "Carne, cebolla, tomate, ketchup, panceta, cheddar y huevo.",
                price: 420,
                icon: "fa-hamburger"
            },
            // EMPANADAS DE QUESO
            {
                id: 18,
                name: "Cebolla y Queso",
                category: "queso",
                description: "Cebolla rehogada y condimentada, con mix de quesos.",
                price: 420,
                icon: "fa-cheese"
            },
            {
                id: 19,
                name: "Calabresa",
                category: "queso",
                description: "Variedad de quesos, morr√≥n y longaniza.",
                price: 420,
                icon: "fa-cheese"
            },
            {
                id: 20,
                name: "Cuatro Quesos",
                category: "queso",
                description: "Muzzarella, dambo, crema de roquefort y parmesano.",
                price: 420,
                icon: "fa-cheese"
            },
            {
                id: 21,
                name: "Queso y Aceitunas",
                category: "queso",
                description: "Olivas en rodajas con mix de quesos.",
                price: 420,
                icon: "fa-cheese"
            },
            {
                id: 22,
                name: "Mafalda de Queso",
                category: "queso",
                description: "Mix de quesos, cebolla rehogada y crocante de panceta.",
                price: 420,
                icon: "fa-cheese"
            },
            {
                id: 23,
                name: "Libanesa",
                category: "queso",
                description: "Mix de quesos, cebolla, ajo en oliva y perejil.",
                price: 420,
                icon: "fa-cheese"
            },
            {
                id: 25,
                name: "Empanada de Provolone",
                category: "queso",
                description: "Provolone, muzzarella, cebolla caramelizada y or√©gano.",
                price: 420,
                icon: "fa-cheese"
            },
            // EMPANADAS DE JAM√ìN
            {
                id: 16,
                name: "Jam√≥n y Queso",
                category: "jamon",
                description: "Mix de quesos con jam√≥n feteado y picado.",
                price: 420,
                icon: "fa-bacon"
            },
            {
                id: 17,
                name: "Jam√≥n y Queso con Cheddar",
                category: "jamon",
                description: "El mix de quesos contiene cheddar y salsa pizzera.",
                price: 420,
                icon: "fa-bacon"
            },
            {
                id: 33,
                name: "Jam√≥n y Choclo",
                category: "jamon",
                description: "Ma√≠z dulce y jam√≥n, ligados con salsa blanca y muzzarella.",
                price: 420,
                icon: "fa-bacon"
            },
            // EMPANADAS DE POLLO
            {
                id: 10,
                name: "Pollo al Curry",
                category: "pollo",
                description: "Pollo, salsa curry y champignon.",
                price: 420,
                icon: "fa-egg"
            },
            {
                id: 11,
                name: "Pollo con Vegetales",
                category: "pollo",
                description: "Pollo grille, con vegetales de estaci√≥n y muzzarella.",
                price: 420,
                icon: "fa-egg"
            },
            {
                id: 12,
                name: "Pollo a la Mostaza",
                category: "pollo",
                description: "Pollo, salsa de mostaza antigua, cebolla y verdeo.",
                price: 420,
                icon: "fa-egg"
            },
            {
                id: 15,
                name: "Pollo con Puerros y Panceta",
                category: "pollo",
                description: "Pollo, muzzarella, puerros, crocante de panceta y cebolla frita.",
                price: 420,
                icon: "fa-egg"
            },
            // EMPANADAS INTEGRALES
            {
                id: 43,
                name: "Integral de Vegetales Asados",
                category: "integral",
                description: "Vegetales de estaci√≥n asados, ricota y muzzarella.",
                price: 420,
                icon: "fa-leaf"
            },
            {
                id: 44,
                name: "Integral Caprese",
                category: "integral",
                description: "Mix de quesos, tomate y albahaca frescos.",
                price: 420,
                icon: "fa-leaf"
            },
            // EMPANADAS VEGANAS
            {
                id: 8,
                name: "Lentejas",
                category: "vegano",
                description: "Lentejas al curry, con espinaca y vegetales rehogados.",
                price: 420,
                icon: "fa-seedling"
            },
            {
                id: 9,
                name: "Soja Parrillera",
                category: "vegano",
                description: "Soja macerada en salsa de soja, con mix de vegetales.",
                price: 420,
                icon: "fa-seedling"
            },
            // EMPANADAS VEGETARIANAS
            {
                id: 31,
                name: "Espinaca",
                category: "verduras",
                description: "Espinaca, cebolla, morr√≥n, con un mix de salsa blanca y quesos.",
                price: 420,
                icon: "fa-carrot"
            },
            {
                id: 32,
                name: "Humita",
                category: "verduras",
                description: "Ma√≠z dulce, morr√≥n, cebolla, salsa blanca y muzzarella.",
                price: 420,
                icon: "fa-carrot"
            },
            {
                id: 34,
                name: "Vegetales Asados",
                category: "verduras",
                description: "Vegetales de estaci√≥n asados, ricotta y muzzarella.",
                price: 420,
                icon: "fa-carrot"
            },
            // EMPANADAS PARA CEL√çACOS
            {
                id: 100,
                name: "Cel√≠acos - Carne",
                category: "sin_gluten",
                description: "SIN GLUTEN. Pack 2 empanadas de carne. Horneadas y congeladas.",
                price: 420,
                icon: "fa-ban"
            },
            {
                id: 101,
                name: "Cel√≠acos - Jam√≥n y Queso",
                category: "sin_gluten",
                description: "SIN GLUTEN. Pack 2 empanadas. Horneadas y congeladas.",
                price: 420,
                icon: "fa-ban"
            },
            // EMPANADAS PREMIUM
            {
                id: 7,
                name: "Empanada de Chivito",
                category: "premium",
                description: "Carne al cuchillo, muzza, mayo, huevo, panceta, cebolla, aceitunas y morr√≥n.",
                price: 420,
                icon: "fa-star"
            },
            {
                id: 24,
                name: "Roquefort",
                category: "premium",
                description: "Queso roquefort, muzzarella, apio y nuez.",
                price: 420,
                icon: "fa-star"
            },
            {
                id: 26,
                name: "Caprese",
                category: "premium",
                description: "Mix de quesos, tomate y albahaca frescos.",
                price: 420,
                icon: "fa-star"
            },
            {
                id: 35,
                name: "At√∫n",
                category: "premium",
                description: "At√∫n, cebolla, huevo, aceitunas y salsa.",
                price: 420,
                icon: "fa-fish"
            },
            // EMPANADAS DULCES
            {
                id: 39,
                name: "Dulce de Leche",
                category: "dulce",
                description: "Dulce de leche con betas de chocolate amargo.",
                price: 420,
                icon: "fa-birthday-cake"
            },
            {
                id: 40,
                name: "Martin Fierro",
                category: "dulce",
                description: "Queso dambo y dulce de membrillo.",
                price: 420,
                icon: "fa-birthday-cake"
            },
            {
                id: 41,
                name: "Manzana con Pasas",
                category: "dulce",
                description: "Manzana con pasas de uva y canela.",
                price: 420,
                icon: "fa-birthday-cake"
            }
        ];

        // Cart
        let cart = [];

        // DOM Elements
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        const productsGrid = document.getElementById('productsGrid');
        const categoryBtns = document.querySelectorAll('.category-btn');
        const cartBtn = document.getElementById('cartBtn');
        const cartSidebar = document.getElementById('cartSidebar');
        const cartOverlay = document.getElementById('cartOverlay');
        const cartClose = document.getElementById('cartClose');
        const cartItems = document.getElementById('cartItems');
        const cartCount = document.getElementById('cartCount');
        const cartTotal = document.getElementById('cartTotal');
        const checkoutBtn = document.getElementById('checkoutBtn');

        // Theme Toggle
        themeToggle.addEventListener('click', () => {
            if (body.classList.contains('light-theme')) {
                body.classList.remove('light-theme');
                body.classList.add('dark-theme');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>Light</span>';
            } else {
                body.classList.remove('dark-theme');
                body.classList.add('light-theme');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i><span>Dark</span>';
            }
        });

        // Render Products
        function renderProducts(category = 'todas') {
            const filteredProducts = category === 'todas' 
                ? products 
                : products.filter(p => p.category === category);
            
            productsGrid.innerHTML = filteredProducts.map(product => `
                <div class="product-card" data-category="${product.category}">
                    <div class="product-image ${product.category}">
                        <img src="empanadas.jpg" alt="${product.name}">
                        ${product.category === 'premium' ? '<span class="product-badge premium">Premium</span>' : ''}
                        ${product.category === 'sin_gluten' ? '<span class="product-badge sin-gluten">Sin TACC</span>' : ''}
                        ${product.category === 'integral' ? '<span class="product-badge integral">Integral</span>' : ''}
                    </div>
                    <div class="product-info">
                        <div class="product-category">${product.category.charAt(0).toUpperCase() + product.category.slice(1)}</div>
                        <h3 class="product-name">${product.name}</h3>
                        <p class="product-description">${product.description}</p>
                        <div class="product-footer">
                            <div class="product-price">${product.price} <span>/ bandeja (8 unidades)</span></div>
                            <button class="add-to-cart" onclick="addToCart(${product.id})">
                                <i class="fas fa-plus"></i> Agregar
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Category Filter
        categoryBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                categoryBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderProducts(btn.dataset.category);
            });
        });

        // Add to Cart
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            
            updateCart();
            openCart();
        }

        // Update Cart
        function updateCart() {
            cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="cart-empty">
                        <i class="fas fa-shopping-basket"></i>
                        <p>Tu carrito est√° vac√≠o</p>
                        <span>Agreg√° empanadas para hacer tu pedido</span>
                    </div>
                `;
                cartTotal.textContent = '$0';
                return;
            }
            
            cartItems.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <button class="cart-item-remove" onclick="removeFromCart(${item.id})" title="Eliminar">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="cart-item-image ${item.category}">
                        <img src="empanadas.jpg" alt="${item.name}">
                    </div>
                    <div class="cart-item-details">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">${item.price}</div>
                        <div class="cart-item-quantity">
                            <button class="qty-btn" onclick="updateQuantity(${item.id}, -1)">-</button>
                            <span>${item.quantity}</span>
                            <button class="qty-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartTotal.textContent = `$${total}`;
        }

        // Update Quantity
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    cart = cart.filter(i => i.id !== productId);
                }
                updateCart();
            }
        }

        // Remove from Cart
        function removeFromCart(productId) {
            cart = cart.filter(i => i.id !== productId);
            updateCart();
        }

        // Cart Sidebar
        function openCart() {
            cartSidebar.classList.add('open');
            cartOverlay.classList.add('open');
        }

        function closeCart() {
            cartSidebar.classList.remove('open');
            cartOverlay.classList.remove('open');
            // Resetear formulario
            const customerForm = document.getElementById('customerForm');
            customerForm.style.display = 'none';
            checkoutBtn.textContent = 'Finalizar Pedido';
            checkoutBtn.disabled = false;
        }

        cartBtn.addEventListener('click', openCart);
        cartClose.addEventListener('click', closeCart);
        cartOverlay.addEventListener('click', closeCart);

        // Checkout con Mercado Pago - Mejorado
        checkoutBtn.addEventListener('click', async () => {
            if (cart.length === 0) {
                alert('Tu carrito est√° vac√≠o');
                return;
            }
            
            // Mostrar formulario si no est√° visible
            const customerForm = document.getElementById('customerForm');
            if (customerForm.style.display === 'none') {
                customerForm.style.display = 'block';
                updateOrderSummary();
                // Configurar fecha m√≠nima (hoy)
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('deliveryDate').min = today;
                document.getElementById('deliveryDate').value = today;
                checkoutBtn.textContent = 'Continuar al Pago';
                return;
            }
            
            // Obtener datos del cliente
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.trim();
            const customerEmail = document.getElementById('customerEmail').value.trim();
            const customerAddress = document.getElementById('customerAddress').value.trim();
            const customerNote = document.getElementById('customerNote').value.trim();
            const deliveryDate = document.getElementById('deliveryDate').value;
            const paymentMethod = document.querySelector('input[name="payment"]:checked');
            const paymentType = paymentMethod ? paymentMethod.value : 'mp';
            
            // Validaciones
            if (!customerName || !customerPhone || !customerEmail) {
                alert('Por favor completa todos los campos obligatorios (*)');
                return;
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(customerEmail)) {
                alert('Por favor ingresa un email v√°lido');
                return;
            }
            
            if (!customerAddress) {
                alert('Por favor ingresa tu direcci√≥n de entrega');
                return;
            }
            
            // Calcular total y cantidad
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalUnidades = itemCount * 8;
            
            // Mostrar resumen del pedido detallado
            let pedidoDetalle = 'üõí RESUMEN DEL PEDIDO\n\n';
            pedidoDetalle += '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n';
            cart.forEach(item => {
                pedidoDetalle += `‚Ä¢ ${item.name}\n`;
                pedidoDetalle += `  ${item.quantity} bandeja(s) = ${item.price * item.quantity}\n\n`;
            });
            pedidoDetalle += '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n';
            pedidoDetalle += `üì¶ Total: ${itemCount} bandeja(s) (${totalUnidades} empanadas)\n`;
            pedidoDetalle += `üí∞ TOTAL A PAGAR: ${total}\n\n`;
            pedidoDetalle += 'üìã DATOS DEL CLIENTE\n';
            pedidoDetalle += '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n';
            pedidoDetalle += `üë§ ${customerName}\n`;
            pedidoDetalle += `üìß ${customerEmail}\n`;
            pedidoDetalle += `üì± ${customerPhone}\n\n`;
            
            pedidoDetalle += 'üöö M√âTODO DE ENTREGA: Delivery\n';
            pedidoDetalle += `üìç ${customerAddress}\n`;
            if (customerNote) pedidoDetalle += `üìù Nota: ${customerNote}\n`;
            
            if (deliveryDate) {
                const fecha = new Date(deliveryDate);
                pedidoDetalle += 'üìÖ Fecha de entrega: ' + fecha.toLocaleDateString('es-UY') + '\n';
            }
            
            // Agregar m√©todo de pago
            if (paymentType === 'cash') {
                pedidoDetalle += `üíµ PAGO: Efectivo en entrega\n`;
            } else {
                pedidoDetalle += `üí≥ PAGO: Mercado Pago\n`;
            }
            
            pedidoDetalle += '\n¬øConfirmar el pedido?';
            
            if (confirm(pedidoDetalle)) {
                // Si son 4 o m√°s bandejas, solo WhatsApp (no hay link de pago configurado)
                if (itemCount >= 4) {
                    // Enviar pedido por WhatsApp para consultar
                    pedidoDetalle += '\n\n‚ö†Ô∏è IMPORTANTE: Este pedido requiere confirmaci√≥n de stock y precio final antes de proceder al pago.';
                    const whatsappMessage = encodeURIComponent(pedidoDetalle);
                    const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${whatsappMessage}`;
                    window.open(whatsappUrl, '_blank');
                    alert('¬°Te redirigimos a WhatsApp! Un vendedor te confirmar√° la disponibilidad y el precio final para este cantidad de bandejas.');
                    cart = [];
                    updateCart();
                    closeCart();
                    return;
                }
                
                if (paymentType === 'cash') {
                    // Enviar pedido por WhatsApp
                    const whatsappMessage = encodeURIComponent(pedidoDetalle);
                    const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${whatsappMessage}`;
                    window.open(whatsappUrl, '_blank');
                    alert('¬°Pedido enviado por WhatsApp! Te contactaremos pronto para confirmar.');
                    cart = [];
                    updateCart();
                    closeCart();
                } else {
                    // Enviar pedido por WhatsApp al vendedor
                    const whatsappMessage = encodeURIComponent(pedidoDetalle);
                    const whatsappUrl = 'https://wa.me/' + WHATSAPP_NUMBER + '?text=' + whatsappMessage;
                    window.open(whatsappUrl, '_blank');
                    
                    // Ir a Mercado Pago
                    let paymentUrl;
                    if (USE_CUSTOM_AMOUNT) {
                        paymentUrl = SINGLE_PAYMENT_LINK;
                    } else {
                        paymentUrl = PAYMENT_LINKS[itemCount] || PAYMENT_LINKS['default'];
                    }
                    window.location.href = paymentUrl;
                }
            }
        });
        
        // Actualizar resumen del pedido en el formulario
        function updateOrderSummary() {
            const orderSummary = document.getElementById('orderSummary');
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalUnidades = itemCount * 8;
            
            let summaryHTML = '<div class="summary-title"><i class="fas fa-shopping-basket"></i> Resumen del pedido:</div>';
            cart.forEach(item => {
                summaryHTML += `<div class="summary-item">
                    <span>${item.name} x${item.quantity}</span>
                    <span>${item.price * item.quantity}</span>
                </div>`;
            });
            summaryHTML += `<div class="summary-total">
                <span>Total (${itemCount} bandeja(s) - ${totalUnidades} empanadas)</span>
                <span>${total}</span>
            </div>`;
            
            orderSummary.innerHTML = summaryHTML;
        }
        


        // Mobile Menu
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navLinks = document.querySelector('.nav-links');
        const navOverlay = document.getElementById('navOverlay');

        mobileMenuBtn.addEventListener('click', () => {
            navLinks.classList.toggle('open');
            navOverlay.classList.toggle('open');
        });

        navOverlay.addEventListener('click', () => {
            navLinks.classList.remove('open');
            navOverlay.classList.remove('open');
        });

        // Close nav when clicking a link
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                navLinks.classList.remove('open');
                navOverlay.classList.remove('open');
            });
        });

        // Handle payment return from Mercado Pago
        function handlePaymentReturn() {
            const urlParams = new URLSearchParams(window.location.search);
            const status = urlParams.get('status');
            
            if (status === 'success') {
                alert('¬°Pago exitoso! Gracias por tu compra. Te enviaremos un email de confirmaci√≥n.');
                cart = [];
                updateCart();
                // Limpiar URL
                window.history.replaceState({}, document.title, window.location.pathname);
            } else if (status === 'failure') {
                alert('El pago no fue completado. Por favor intenta nuevamente.');
                window.history.replaceState({}, document.title, window.location.pathname);
            } else if (status === 'pending') {
                alert('El pago est√° siendo procesado. Te notificaremos cuando se confirme.');
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }

        // Initialize
        renderProducts();
        handlePaymentReturn();
    </script>
</body>
</html>
